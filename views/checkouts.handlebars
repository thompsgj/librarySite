{{#section 'css'}}

		div {
		    position: relative;
		}
		#search {
		    position: absolute;
		    top: 0;
		    left: 0;
		    z-index: 11;
		    background: transparent;
		    
		}
		#autocomplete {
		    position: absolute;    
		    top: 2px;
		    left: 1px; 
		    background: transparent;
		    z-index: 10;
		    border: 0px;
		}

		.checkouts li {
			padding: 0px;
			margin: 0px;
		}

		.checkouts .label {
			font-weight: bold;
		}
{{/section}}

<h1>Checkout List</h1>

<div ng-controller="chkoutListCtrl">
	<h3>Filter Results</h3>
	Student ID
	<input type="text" ng-model="search.student.studentId"></input><br>
	Student Phone
	<input type="text" ng-model="search.student.studentPhone"></input>

<!-- Need to send checkout id and book code to the server -->
	<div ng-repeat="chkoutEntry in chkoutEntries | filter : search">
		<div class="checkouts" id="\{{chkoutEntry._id}}">
				<div class="entry">
					<div class="student">
						<span class="label">Student:</span> \{{chkoutEntry.student.studentId}}
						<span class="label">Contact Number:</span> \{{chkoutEntry.student.studentPhone}}
						<span class="label"> Email: </span> \{{chkoutEntry.student.studentEmail}}
					</div>
					<div class="other">
						<span class="label">Teacher:</span> \{{chkoutEntry.student.teacher}}
					</div>
					<div class="book" ng-repeat= "book in chkoutEntry.books">
						<div class="info">
							<span class="label">Title:</span> \{{book.title}}
							<span class="label">Code:</span> <span class="codeid">\{{book.code}}<span>
						</div>				
					</div>
					<div class="date">
						<span class="label">Due Date:</span> \{{chkoutEntry.dates.returnDate}}
					</div>		

					<form class="form-horizontal" role="form" action="/book/checkout/return" method="POST" onsubmit="return confirm('Do you really want to return these books?')">
						<input type="hidden" name="_id" value=\{{chkoutEntry._id}}>
						<input type="hidden" name="books" value=\{{chkoutEntry}}>
						<button class="return" name="return" type="submit" >Return All</button>
					</form>
					<form class="form-horizontal" role="form" action="/book/checkout/extend" method="POST">
						<input type="hidden" name="_id" value=\{{chkoutEntry._id}}>
						<button class="extend" name="extend" type="submit">Extend All</button>
					</form>
					<!--a.btn.btn-default.pull-right(href='/location/#{location._id}/review/new') -->
				</div>
			</ul>
		</div>
	</div>
</div>


{{#section 'jcode'}}
/*
$(document).ready(function() {
	$(".return").click(function() {
		location.reload();
	})
})
*/
//NEED TO REMODEL THIS SECTION SO THAT EACH BOOK CAN BE RETURNED SEPARATELY OR ALL TOGETHER

/*  	WORKING
	$(".extend").click(function() {
		var entry = $(this).val()
		$.ajax({
			url: "/book/checkout/extend",
			type: "POST",
			dataType: "json",
			contentType: "application/json; charset=UTF-8",
			data: JSON.stringify({_id: entry})
		}).done(function() {
			location.reload();
		}).fail(function() {
			alert("FAIL")
		})
	})

	$(".return").click(function() {
		var entry = $(this).val()
		var studid = $(this).parent().find('.studid').text();
		var codeid = parseInt($(this).parent().find('.codeid').text());
		alert(codeid)
		$.ajax({
			url: "/book/checkout/return",
			type: "POST",
			dataType: "json",
			contentType: "application/json; charset=UTF-8",
			data: JSON.stringify({_id: entry, code: codeid})
		}).done(function() {
			location.reload();
		}).fail(function() {
			alert("FAIL")
		})
	})

*/





/*
		$(".extend").click(function(){
			//Collect variables from parent div
			var studid = $(this).parent().find('.studid').text();
			var codeid = parseInt($(this).parent().find('.codeid').text());

			//Send/Receive data from the server
			$.ajax({
				url: "/process-extend",
				type: "POST",
				dataType:"json",
				contentType: "application/json; charset=UTF-8",
				data: JSON.stringify({student: studid, code: codeid}),
			}).done(function() {
				alert("Extended")
			}).fail(function() {
				alert("FAIL")
			})			
		})

		$('.return').click(function(){
			//Set parent div as variable
			var placeholder = $(this).parent().remove();

			//Collect variables from parent div
			var studid = $(this).parent().find('.studid').text();
			var codeid = parseInt($(this).parent().find('.codeid').text());

			//Send/Receive data from the server
			$.ajax({
				url: "/process-rtrn2",
				type: "POST",
				dataType:"json",
				contentType: "application/json; charset=UTF-8",
				data: JSON.stringify({student: studid, code: codeid}),
			}).done(function() {
				placeholder
			}).fail(function() {
				alert("FAIL")
			})
		})
*/
{{/section}}
